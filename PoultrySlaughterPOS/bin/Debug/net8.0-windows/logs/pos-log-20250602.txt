2025-06-02 11:03:08.677 +03:00 [INF] Starting Poultry Slaughter POS application with complete dialog integration...
2025-06-02 11:03:09.384 +03:00 [INF] Database configuration - UseExplicitTransactions: true, EnableRetryOnFailure: false
2025-06-02 11:03:09.454 +03:00 [INF] Service configuration completed successfully with 103 services registered (complete dialog integration)
2025-06-02 11:03:09.546 +03:00 [INF] Application started. Press Ctrl+C to shut down.
2025-06-02 11:03:09.553 +03:00 [INF] Hosting environment: Production
2025-06-02 11:03:09.554 +03:00 [INF] Content root path: C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\bin\Debug\net8.0-windows
2025-06-02 11:03:09.554 +03:00 [INF] Application host started successfully with complete dialog integration
2025-06-02 11:03:09.697 +03:00 [INF] Starting database initialization for SQL Server...
2025-06-02 11:03:10.919 +03:00 [INF] Verifying SQL Server instance with connection: Server=.\posserver;Database=chicken;Trusted_Connection=True;MultipleActiveResultSets=true;TrustServerCertificate=True
2025-06-02 11:03:11.453 +03:00 [INF] Testing SQL Server connection...
2025-06-02 11:03:11.583 +03:00 [INF] SQL Server connection successful.
2025-06-02 11:03:11.751 +03:00 [INF] Database 'chicken' created/verified successfully.
2025-06-02 11:03:12.273 +03:00 [INF] Database schema verification completed:
2025-06-02 11:03:12.273 +03:00 [INF] - TRUCKS: 3 records
2025-06-02 11:03:12.273 +03:00 [INF] - CUSTOMERS: 3 records
2025-06-02 11:03:12.273 +03:00 [INF] - TRUCK_LOADS: 3 records
2025-06-02 11:03:12.273 +03:00 [INF] - INVOICES: 34 records
2025-06-02 11:03:12.273 +03:00 [INF] - PAYMENTS: 0 records
2025-06-02 11:03:12.273 +03:00 [INF] - DAILY_RECONCILIATION: 0 records
2025-06-02 11:03:12.273 +03:00 [INF] - AUDIT_LOGS: 71 records
2025-06-02 11:03:12.273 +03:00 [INF] Database initialization completed successfully.
2025-06-02 11:03:12.274 +03:00 [INF] Database initialization completed successfully
2025-06-02 11:03:13.014 +03:00 [INF] MainWindow initialized successfully with complete POS navigation integration
2025-06-02 11:03:13.456 +03:00 [INF] MainWindow loaded, starting initialization with POS module support
2025-06-02 11:03:13.633 +03:00 [INF] Poultry Slaughter POS application started successfully with complete integration
2025-06-02 11:03:13.730 +03:00 [INF] Dashboard initialized - Trucks: 3, Customers: 3, Today's Invoices: 0
2025-06-02 11:03:13.730 +03:00 [INF] MainWindow initialization completed successfully with POS integration
2025-06-02 11:03:18.365 +03:00 [INF] Navigating to page: Dashboard
2025-06-02 11:03:18.457 +03:00 [INF] Successfully navigated to page: Dashboard
2025-06-02 11:03:20.257 +03:00 [INF] Navigating to page: TruckLoading
2025-06-02 11:03:20.263 +03:00 [INF] SQL Server retry strategy disabled to support explicit transactions
2025-06-02 11:03:20.293 +03:00 [INF] TruckLoadingViewModel initialized with enhanced save functionality and debugging capabilities
2025-06-02 11:03:20.429 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:03:20.435 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:03:20.807 +03:00 [INF] TruckLoadingView loaded, initializing ViewModel with save functionality
2025-06-02 11:03:20.807 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:03:20.807 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:03:21.560 +03:00 [INF] Found 3 available trucks for loading
2025-06-02 11:03:21.709 +03:00 [INF] Found 3 available trucks for loading
2025-06-02 11:03:21.732 +03:00 [INF] Executed DbCommand (11ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:03:21.761 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'PoultrySlaughterPOS.Data.PoultryDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-02 11:03:21.867 +03:00 [ERR] Error retrieving truck loads for date "2025-06-02T00:00:00.0000000+03:00"
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
2025-06-02 11:03:21.994 +03:00 [ERR] Error retrieving today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:03:22.004 +03:00 [ERR] Error 3d127472 in GetTodaysTruckLoadsAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:03:22.088 +03:00 [ERR] Error loading today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
2025-06-02 11:03:22.172 +03:00 [ERR] Error loading truck loading data after 1363ms
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:03:22.173 +03:00 [ERR] Error ca7d6ae2 in LoadDataAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:03:22.177 +03:00 [WRN] Error message displayed: فشل في تحميل البيانات. يرجى المحاولة مرة أخرى.
2025-06-02 11:03:22.184 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:03:22.184 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:03:22.185 +03:00 [INF] TruckLoadingView initialization completed successfully in 1378ms
2025-06-02 11:03:22.324 +03:00 [INF] Truck loading data loaded successfully in 1363ms
2025-06-02 11:03:22.324 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:03:22.324 +03:00 [INF] Truck loading page loaded successfully
2025-06-02 11:03:22.324 +03:00 [INF] Successfully navigated to page: TruckLoading
2025-06-02 11:03:25.688 +03:00 [WRN] Validation failed with 2 errors: الوزن يجب أن يكون بين 0.01 و 10000 كيلو, عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:32.222 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:34.974 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:35.508 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:35.707 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:35.862 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:03:39.933 +03:00 [WRN] Validation failed with 1 errors: متوسط وزن القفص (1500.00 كيلو) غير طبيعي. يجب أن يكون بين 5 و 100 كيلو
2025-06-02 11:03:40.196 +03:00 [WRN] Validation failed with 1 errors: متوسط وزن القفص (150.00 كيلو) غير طبيعي. يجب أن يكون بين 5 و 100 كيلو
2025-06-02 11:03:47.030 +03:00 [INF] Starting truck load save operation for truck 1 with weight 3000kg and 200 cages
2025-06-02 11:03:47.185 +03:00 [INF] Creating truck load for truck 1 with weight 3000 and 200 cages
2025-06-02 11:03:47.602 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-06-02 11:03:47.617 +03:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 10), @p4='?' (Size = 50), @p5='?' (Size = 50), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = DateTime2), @p9='?' (Size = 500), @p10='?' (Size = 20), @p11='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SET NOCOUNT ON;
INSERT INTO [AUDIT_LOGS] ([CreatedDate], [NewValues], [OldValues], [Operation], [TableName], [UserId])
OUTPUT INSERTED.[AuditId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
INSERT INTO [TRUCK_LOADS] ([CagesCount], [CreatedDate], [LoadDate], [Notes], [Status], [TotalWeight], [TruckId], [UpdatedDate])
OUTPUT INSERTED.[LoadId]
VALUES (@p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-06-02 11:03:47.644 +03:00 [INF] Successfully saved 2 changes to database for user SYSTEM
2025-06-02 11:03:47.654 +03:00 [INF] Successfully created truck load 4 for truck 1
2025-06-02 11:03:47.655 +03:00 [INF] Truck load saved successfully with ID 4 in 624ms
2025-06-02 11:03:47.660 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:03:47.691 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:03:47.782 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:03:47.957 +03:00 [INF] Found 2 available trucks for loading
2025-06-02 11:03:47.979 +03:00 [INF] Success message displayed: تم حفظ تحميل الشاحنة بنجاح - رقم العملية: 4
2025-06-02 11:03:50.276 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:03:50.277 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:03:50.300 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:03:50.363 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:03:50.380 +03:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:03:50.457 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:03:50.460 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:03:50.464 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:03:50.520 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:03:50.569 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:03:50.578 +03:00 [INF] Generated optimized invoice number: 202506020001
2025-06-02 11:03:50.626 +03:00 [INF] Real invoice number generated and set: 202506020001
2025-06-02 11:03:50.627 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:03:50.630 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:03:50.631 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:03:50.632 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:03:50.639 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:03:50.680 +03:00 [INF] Generated optimized invoice number: 202506020001
2025-06-02 11:03:50.681 +03:00 [INF] Real invoice number generated and set: 202506020001
2025-06-02 11:03:50.682 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:03:50.683 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:03:50.687 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:03:50.692 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:04:18.258 +03:00 [INF] Navigating to page: Dashboard
2025-06-02 11:04:18.311 +03:00 [INF] Successfully navigated to page: Dashboard
2025-06-02 11:04:37.405 +03:00 [INF] Navigating to page: TruckLoading
2025-06-02 11:04:37.407 +03:00 [INF] TruckLoadingViewModel initialized with enhanced save functionality and debugging capabilities
2025-06-02 11:04:37.451 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:04:37.452 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:04:37.521 +03:00 [INF] TruckLoadingView loaded, initializing ViewModel with save functionality
2025-06-02 11:04:37.521 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:04:37.521 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:04:37.833 +03:00 [INF] Found 2 available trucks for loading
2025-06-02 11:04:37.835 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:04:37.837 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:04:37.893 +03:00 [INF] Found 2 available trucks for loading
2025-06-02 11:04:37.894 +03:00 [INF] Truck loading data loaded successfully in 372ms
2025-06-02 11:04:37.894 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:04:37.895 +03:00 [INF] Truck loading page loaded successfully
2025-06-02 11:04:37.895 +03:00 [INF] Successfully navigated to page: TruckLoading
2025-06-02 11:04:37.896 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:04:37.911 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:04:37.951 +03:00 [INF] Truck loading data loaded successfully in 372ms
2025-06-02 11:04:37.951 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:04:37.951 +03:00 [INF] TruckLoadingView initialization completed successfully in 430ms
2025-06-02 11:04:43.961 +03:00 [WRN] Validation failed with 2 errors: الوزن يجب أن يكون بين 0.01 و 10000 كيلو, عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:04:52.180 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:04:52.185 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:04:52.334 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:04:52.547 +03:00 [WRN] Validation failed with 1 errors: عدد الأقفاص يجب أن يكون بين 1 و 1000
2025-06-02 11:04:57.288 +03:00 [WRN] Validation failed with 1 errors: متوسط وزن القفص (2000.00 كيلو) غير طبيعي. يجب أن يكون بين 5 و 100 كيلو
2025-06-02 11:04:57.592 +03:00 [WRN] Validation failed with 1 errors: متوسط وزن القفص (200.00 كيلو) غير طبيعي. يجب أن يكون بين 5 و 100 كيلو
2025-06-02 11:05:07.115 +03:00 [INF] Starting truck load save operation for truck 2 with weight 2000kg and 100 cages
2025-06-02 11:05:07.253 +03:00 [INF] Creating truck load for truck 2 with weight 2000 and 100 cages
2025-06-02 11:05:07.385 +03:00 [WRN] Savepoints are disabled because Multiple Active Result Sets (MARS) is enabled. If 'SaveChanges' fails, then the transaction cannot be automatically rolled back to a known clean state. Instead, the transaction should be rolled back by the application before retrying 'SaveChanges'. See https://go.microsoft.com/fwlink/?linkid=2149338 for more information and examples. To identify the code which triggers this warning, call 'ConfigureWarnings(w => w.Throw(SqlServerEventId.SavepointsDisabledBecauseOfMARS))'.
2025-06-02 11:05:07.820 +03:00 [INF] Executed DbCommand (435ms) [Parameters=[@p0='?' (DbType = DateTime2), @p1='?' (Size = 4000), @p2='?' (Size = 4000), @p3='?' (Size = 10), @p4='?' (Size = 50), @p5='?' (Size = 50), @p6='?' (DbType = Int32), @p7='?' (DbType = DateTime2), @p8='?' (DbType = DateTime2), @p9='?' (Size = 500), @p10='?' (Size = 20), @p11='?' (Precision = 10) (Scale = 2) (DbType = Decimal), @p12='?' (DbType = Int32), @p13='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SET NOCOUNT ON;
INSERT INTO [AUDIT_LOGS] ([CreatedDate], [NewValues], [OldValues], [Operation], [TableName], [UserId])
OUTPUT INSERTED.[AuditId]
VALUES (@p0, @p1, @p2, @p3, @p4, @p5);
INSERT INTO [TRUCK_LOADS] ([CagesCount], [CreatedDate], [LoadDate], [Notes], [Status], [TotalWeight], [TruckId], [UpdatedDate])
OUTPUT INSERTED.[LoadId]
VALUES (@p6, @p7, @p8, @p9, @p10, @p11, @p12, @p13);
2025-06-02 11:05:07.822 +03:00 [INF] Successfully saved 2 changes to database for user SYSTEM
2025-06-02 11:05:07.823 +03:00 [INF] Successfully created truck load 5 for truck 2
2025-06-02 11:05:07.824 +03:00 [INF] Truck load saved successfully with ID 5 in 708ms
2025-06-02 11:05:07.876 +03:00 [INF] Executed DbCommand (51ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:05:07.889 +03:00 [INF] Executed DbCommand (3ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:05:07.972 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:05:08.172 +03:00 [INF] Found 1 available trucks for loading
2025-06-02 11:05:08.173 +03:00 [INF] Success message displayed: تم حفظ تحميل الشاحنة بنجاح - رقم العملية: 5
2025-06-02 11:05:36.272 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:05:36.272 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:05:36.273 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:05:36.294 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:05:36.312 +03:00 [INF] Executed DbCommand (14ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:05:36.362 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:05:36.363 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:05:36.365 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:05:36.409 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:05:36.453 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:05:36.454 +03:00 [INF] Generated optimized invoice number: 202506020001
2025-06-02 11:05:36.496 +03:00 [INF] Real invoice number generated and set: 202506020001
2025-06-02 11:05:36.496 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:05:36.498 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:05:36.498 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:05:36.498 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:05:36.508 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:05:36.550 +03:00 [INF] Generated optimized invoice number: 202506020001
2025-06-02 11:05:36.551 +03:00 [INF] Real invoice number generated and set: 202506020001
2025-06-02 11:05:36.551 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:05:36.552 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:05:36.554 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:05:36.557 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:06:33.309 +03:00 [INF] Adding new invoice item to collection
2025-06-02 11:07:09.681 +03:00 [INF] Adding new invoice item to collection
2025-06-02 11:09:02.310 +03:00 [INF] Executing SaveAndPrintInvoice command for bulk invoice
2025-06-02 11:09:02.566 +03:00 [INF] Successfully created invoice 202506020001 for customer 3 with amount 0
2025-06-02 11:09:02.566 +03:00 [INF] Bulk invoice saved successfully - Number: 202506020001, Items: 3, Amount: 0
2025-06-02 11:09:02.567 +03:00 [INF] Starting enhanced bulk invoice printing with individual cage entries for Invoice: 202506020001
2025-06-02 11:09:02.593 +03:00 [INF] Enhanced receipt totals calculated for 3 individual cage entries - Total: $312.64000
2025-06-02 11:09:02.600 +03:00 [INF] Enhanced receipt totals calculated for 3 individual cage entries - Total: $312.64000
2025-06-02 11:09:18.856 +03:00 [INF] Enhanced individual cage receipt printing completed successfully
2025-06-02 11:09:18.939 +03:00 [INF] Generated optimized invoice number: 202506020002
2025-06-02 11:10:11.705 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:10:11.705 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:10:11.709 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:10:11.737 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:10:11.772 +03:00 [INF] Executed DbCommand (31ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:10:11.811 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:10:11.813 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:10:11.816 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:10:11.874 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:10:11.931 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:10:11.981 +03:00 [INF] Generated optimized invoice number: 202506020002
2025-06-02 11:10:11.981 +03:00 [INF] Real invoice number generated and set: 202506020002
2025-06-02 11:10:11.981 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:10:11.984 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:10:11.984 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:10:11.984 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:10:11.990 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:10:12.032 +03:00 [INF] Generated optimized invoice number: 202506020002
2025-06-02 11:10:12.033 +03:00 [INF] Real invoice number generated and set: 202506020002
2025-06-02 11:10:12.033 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:10:12.034 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:10:12.037 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:10:12.040 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:10:52.722 +03:00 [INF] Adding new invoice item to collection
2025-06-02 11:11:19.973 +03:00 [INF] Adding new invoice item to collection
2025-06-02 11:12:24.384 +03:00 [INF] Executing SaveAndPrintInvoice command for bulk invoice
2025-06-02 11:12:24.624 +03:00 [INF] Successfully created invoice 202506020002 for customer 1 with amount 0
2025-06-02 11:12:24.625 +03:00 [INF] Bulk invoice saved successfully - Number: 202506020002, Items: 3, Amount: 0
2025-06-02 11:12:24.625 +03:00 [INF] Starting enhanced bulk invoice printing with individual cage entries for Invoice: 202506020002
2025-06-02 11:12:24.627 +03:00 [INF] Enhanced receipt totals calculated for 3 individual cage entries - Total: $588.20000
2025-06-02 11:12:24.631 +03:00 [INF] Enhanced receipt totals calculated for 3 individual cage entries - Total: $588.20000
2025-06-02 11:12:54.708 +03:00 [INF] Enhanced individual cage receipt printing completed successfully
2025-06-02 11:12:54.802 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:18:19.413 +03:00 [INF] Navigating to page: TruckLoading
2025-06-02 11:18:19.415 +03:00 [INF] TruckLoadingViewModel initialized with enhanced save functionality and debugging capabilities
2025-06-02 11:18:19.435 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:18:19.435 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:18:19.524 +03:00 [INF] TruckLoadingView loaded, initializing ViewModel with save functionality
2025-06-02 11:18:19.524 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:18:19.524 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:18:19.831 +03:00 [INF] Found 1 available trucks for loading
2025-06-02 11:18:19.835 +03:00 [INF] Found 1 available trucks for loading
2025-06-02 11:18:19.837 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'PoultrySlaughterPOS.Data.PoultryDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-02 11:18:19.837 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:18:19.892 +03:00 [ERR] Error retrieving truck loads for date "2025-06-02T00:00:00.0000000+03:00"
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
2025-06-02 11:18:19.975 +03:00 [ERR] Error retrieving today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:18:19.976 +03:00 [ERR] Error aa3299a4 in GetTodaysTruckLoadsAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:18:20.054 +03:00 [ERR] Error loading today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
2025-06-02 11:18:20.122 +03:00 [ERR] Error loading truck loading data after 597ms
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:18:20.124 +03:00 [ERR] Error 197bd577 in LoadDataAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:18:20.125 +03:00 [WRN] Error message displayed: فشل في تحميل البيانات. يرجى المحاولة مرة أخرى.
2025-06-02 11:18:20.127 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:18:20.127 +03:00 [INF] TruckLoadingView initialization completed successfully in 603ms
2025-06-02 11:18:20.128 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:18:20.177 +03:00 [INF] Truck loading data loaded successfully in 597ms
2025-06-02 11:18:20.177 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:18:20.177 +03:00 [INF] Truck loading page loaded successfully
2025-06-02 11:18:20.177 +03:00 [INF] Successfully navigated to page: TruckLoading
2025-06-02 11:22:03.528 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:22:03.529 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:22:03.530 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:22:03.541 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:22:03.564 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:03.639 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:22:03.641 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:03.645 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:03.687 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:03.738 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:03.778 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:03.787 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:03.831 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:03.831 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:03.831 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:03.834 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:22:03.834 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:22:03.834 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:22:03.856 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:03.857 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:03.857 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:22:03.867 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:22:03.881 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:22:05.836 +03:00 [INF] Navigating to page: TruckLoading
2025-06-02 11:22:05.836 +03:00 [INF] TruckLoadingViewModel initialized with enhanced save functionality and debugging capabilities
2025-06-02 11:22:05.870 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:22:05.870 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:22:05.968 +03:00 [INF] TruckLoadingView loaded, initializing ViewModel with save functionality
2025-06-02 11:22:05.968 +03:00 [INF] Initializing TruckLoadingViewModel with enhanced save capabilities
2025-06-02 11:22:05.968 +03:00 [INF] Retrieving available trucks for loading
2025-06-02 11:22:06.273 +03:00 [INF] Found 1 available trucks for loading
2025-06-02 11:22:06.279 +03:00 [INF] Found 1 available trucks for loading
2025-06-02 11:22:06.279 +03:00 [INF] Executed DbCommand (6ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:22:06.281 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:22:06.281 +03:00 [ERR] An exception occurred while iterating over the results of a query for context type 'PoultrySlaughterPOS.Data.PoultryDbContext'.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
2025-06-02 11:22:06.314 +03:00 [ERR] Error retrieving truck loads for date "2025-06-02T00:00:00.0000000+03:00"
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
2025-06-02 11:22:06.393 +03:00 [ERR] Error retrieving today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:22:06.394 +03:00 [ERR] Error ff36f935 in GetTodaysTruckLoadsAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
2025-06-02 11:22:06.472 +03:00 [ERR] Error loading today's truck loads
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
2025-06-02 11:22:06.547 +03:00 [ERR] Error loading truck loading data after 578ms
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:22:06.550 +03:00 [ERR] Error 569b532b in LoadDataAsync: InvalidOperationException - A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
System.InvalidOperationException: A second operation was started on this context instance before a previous operation completed. This is usually caused by different threads concurrently using the same instance of DbContext. For more information on how to avoid threading issues with DbContext, see https://go.microsoft.com/fwlink/?linkid=2097913.
   at Microsoft.EntityFrameworkCore.Infrastructure.Internal.ConcurrencyDetector.EnterCriticalSection()
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.EntityFrameworkQueryableExtensions.ToListAsync[TSource](IQueryable`1 source, CancellationToken cancellationToken)
   at PoultrySlaughterPOS.Services.Repositories.TruckLoadRepository.GetTruckLoadsByDateAsync(DateTime loadDate, CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\Repositories\Implementations\TruckLoadRepository.cs:line 47
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 253
   at PoultrySlaughterPOS.Services.TruckLoadingService.GetTodaysTruckLoadsAsync(CancellationToken cancellationToken) in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\Services\TruckLoadingService.cs:line 259
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadTodaysTruckLoadsAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 410
   at PoultrySlaughterPOS.ViewModels.TruckLoadingViewModel.LoadDataAsync() in C:\Users\$\Desktop\PoultrySlaughterPOS\PoultrySlaughterPOS\ViewModels\TruckLoadingViewModel.cs:line 134
2025-06-02 11:22:06.552 +03:00 [WRN] Error message displayed: فشل في تحميل البيانات. يرجى المحاولة مرة أخرى.
2025-06-02 11:22:06.553 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:22:06.553 +03:00 [INF] Truck loading page loaded successfully
2025-06-02 11:22:06.553 +03:00 [INF] Successfully navigated to page: TruckLoading
2025-06-02 11:22:06.555 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[@__targetDate_0='?' (DbType = DateTime2), @__nextDate_1='?' (DbType = DateTime2)], CommandType='"Text"', CommandTimeout='60']
SELECT [t].[LoadId], [t].[CagesCount], [t].[CreatedDate], [t].[LoadDate], [t].[Notes], [t].[Status], [t].[TotalWeight], [t].[TruckId], [t].[UpdatedDate], [t0].[TruckId], [t0].[CreatedDate], [t0].[DriverName], [t0].[IsActive], [t0].[TruckNumber], [t0].[UpdatedDate]
FROM [TRUCK_LOADS] AS [t]
INNER JOIN [TRUCKS] AS [t0] ON [t].[TruckId] = [t0].[TruckId]
WHERE [t].[LoadDate] >= @__targetDate_0 AND [t].[LoadDate] < @__nextDate_1
ORDER BY [t].[TruckId], [t].[LoadDate]
2025-06-02 11:22:06.602 +03:00 [INF] Truck loading data loaded successfully in 578ms
2025-06-02 11:22:06.602 +03:00 [INF] TruckLoadingViewModel initialized successfully
2025-06-02 11:22:06.602 +03:00 [INF] TruckLoadingView initialization completed successfully in 634ms
2025-06-02 11:22:10.967 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:22:10.967 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:22:10.967 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:22:11.005 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:22:11.011 +03:00 [INF] Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:11.012 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:11.139 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:22:11.140 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:11.143 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:11.181 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:11.181 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:11.181 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:11.183 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:22:11.183 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:22:11.183 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:22:11.207 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:11.259 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:11.303 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:11.307 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:11.308 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:11.308 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:22:11.313 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:22:11.329 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:22:23.204 +03:00 [INF] Navigating to page: CustomerAccounts
2025-06-02 11:22:23.211 +03:00 [INF] Successfully navigated to page: CustomerAccounts
2025-06-02 11:22:24.304 +03:00 [INF] Navigating to page: CustomerAccounts
2025-06-02 11:22:24.304 +03:00 [INF] Successfully navigated to page: CustomerAccounts
2025-06-02 11:22:32.564 +03:00 [INF] Navigating to page: TransactionHistory
2025-06-02 11:22:32.565 +03:00 [INF] Successfully navigated to page: TransactionHistory
2025-06-02 11:22:40.537 +03:00 [INF] Navigating to page: Reports
2025-06-02 11:22:40.538 +03:00 [INF] Successfully navigated to page: Reports
2025-06-02 11:22:49.868 +03:00 [INF] Navigating to page: POSSales
2025-06-02 11:22:49.868 +03:00 [INF] Loading POS Sales page with full dependency injection
2025-06-02 11:22:49.870 +03:00 [INF] POSViewModel initialized with immediate invoice number display
2025-06-02 11:22:49.925 +03:00 [INF] Enhanced POSView initialized successfully with modern scrollable design
2025-06-02 11:22:49.946 +03:00 [INF] Executed DbCommand (20ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:50.014 +03:00 [INF] Initializing enhanced POSView with comprehensive data loading
2025-06-02 11:22:50.016 +03:00 [INF] Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='60']
SELECT [c].[CustomerId], [c].[Address], [c].[CreatedDate], [c].[CustomerName], [c].[IsActive], [c].[PhoneNumber], [c].[TotalDebt], [c].[UpdatedDate]
FROM [CUSTOMERS] AS [c]
WHERE [c].[IsActive] = CAST(1 AS bit)
ORDER BY [c].[CustomerName]
2025-06-02 11:22:50.018 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:50.060 +03:00 [INF] Loaded 3 active customers
2025-06-02 11:22:50.115 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:50.160 +03:00 [INF] Loaded 3 active trucks
2025-06-02 11:22:50.168 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:50.206 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:50.206 +03:00 [INF] Generated optimized invoice number: 202506020003
2025-06-02 11:22:50.207 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:50.209 +03:00 [INF] POS ViewModel initialized with customer and truck data
2025-06-02 11:22:50.209 +03:00 [INF] POS Sales page loaded successfully with full functionality
2025-06-02 11:22:50.209 +03:00 [INF] Successfully navigated to page: POSSales
2025-06-02 11:22:50.232 +03:00 [INF] Real invoice number generated and set: 202506020003
2025-06-02 11:22:50.233 +03:00 [INF] POSViewModel initialized successfully with real invoice number
2025-06-02 11:22:50.234 +03:00 [INF] Enhanced POSView initialization completed successfully
2025-06-02 11:22:50.245 +03:00 [INF] Applying emergency TextBox visibility fix
2025-06-02 11:22:50.259 +03:00 [INF] Emergency TextBox visibility fix applied successfully
2025-06-02 11:26:40.184 +03:00 [INF] Adding new invoice item to collection
2025-06-02 11:26:43.308 +03:00 [INF] Removing invoice item from collection
2025-06-02 11:27:04.847 +03:00 [INF] MainWindow closing, performing cleanup
2025-06-02 11:27:04.847 +03:00 [INF] MainWindow cleanup completed
2025-06-02 11:27:04.907 +03:00 [INF] Shutting down Poultry Slaughter POS application...
2025-06-02 11:27:04.914 +03:00 [INF] Application is shutting down...
2025-06-02 11:27:04.946 +03:00 [INF] Application host stopped successfully
2025-06-02 11:27:04.946 +03:00 [INF] Poultry Slaughter POS application shutdown completed
